# SQL Schema 개발 및 관리 메뉴얼

> 최초작성일: 2025-11-06  
> 최신개정일: 2026-02-28  
> 최신개정자: 이한경  
> 작성자: 이한경  

- 이 프로젝트는 postgresql 17, flyway 12를 사용합니다.

## DB 폴더

- DB 데이터는 `data/`에 volume으로 연결됩니다.

## SQL 스크립트

- SQL 스크립트 파일은 `/script/migrations/` 폴더에 있습니다.
- sqlite3에서 postgresql 17로 이전 시 DB 초기화 스크립트를 기준으로 `V1__init.sql`을 작성하였습니다. 
- 새로 생성되는 DB 파일은 V1과 그 이후 마이그레이션을 순서대로 실행하여 생성됩니다.
  - `V1 -> V2 -> V3 -> V4 ...`

### DB 마이그레이션 작성법

- 마이그레이션 파일은 `V{i}__description.sql` 형식의 이름으로 `/script/migrations/` 폴더에 작성합니다. V1 이후 마이그레이션은 V2, V3, V4 등으로 작성합니다. 
- 한 번 작성된 마이그레이션을 수정하여서는 안 됩니다. 마이그레이션은 버전 숫자가 더 작은 모든 파일이 반영되었음을 가정합니다. 
- 마이그레이션은 유효한 postgresql 17 문법을 사용해야 하고, 되도록 마이그레이션 전체를 하나의 트랜잭션으로 작성합니다.
